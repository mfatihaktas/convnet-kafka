<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>README.html</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

</head>

<body>

<h1>convnet</h1>
<p>Convnet is a basic Python library to classify images with CNN.
It provides two functionalities:
* Train a basic CNN on a given data set.
* Predict the class names for a given array of images.</p>
<h2>Implementation</h2>
<p>It is implemented as a sinle-class library.</p>
<h2>Installation</h2>
<p>Navigate to the root folder, and run the following commands:</p>
<p><code>bash
python3 setup.py bdist_wheel
pip3 install --force-reinstall dist/convnetlib-0.1.0-py3-*.whl</code></p>
<p>These commands are also provided in <a href="cmd.sh">cmd.sh</a> for convenience.</p>
<h2>Usage</h2>
<p>```python
import glob, PIL
import numpy as np
from convnetlib import convnet
from convnetlib import convnet</p>
<p>model = convnet.ConvNet(training_data_dir='/path/to/mnist-data/training',
                                              class_names=['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'])
img_path_l = glob.glob('/path/to/imgs/*.png')
    n = len(img_path_l)</p>
<pre><code>plot.figure(figsize=(12, 12))
for i, img_path in enumerate(img_path_l):
    with open(img_path, 'rb') as f:
        img = PIL.Image.open(f)
        img_rgb = img.convert('RGB')
        array = np.asarray(img_rgb)
        array = np.expand_dims(array, axis=0)
        label = model.get_predicted_class_labels(array)[0]
        log(INFO, "predicted label= {}".format(label))

    plot.subplot(5, 5, i + 1)
    plot.xticks([])
    plot.yticks([])
    plot.grid(False)
    plot.imshow(np.asarray(img), cmap='gray')
    plot.xlabel(label)

plot.savefig("plot_test_results.png", bbox_inches='tight')
</code></pre>
<p>```</p>
<p>Once a <code>ConvNet</code> instance is constructed, it will check if a previously
trained model exists in <code>./checkpoint</code>. If so, the old model will be loaded. If not, a new model
will be trained over the data set in <code>training_data_dir</code>. If a new model needs to be trained
despite the presence of an old model, then <code>train()</code> should be called explicity on the model.
Note that the model in <code>./checkpoint</code> will be replaced only if the newly trained model achieves
higher accuracy than the old one.
<code>python
model = ConvNetModel(training_data_dir='./training', class_names=['0', '1'])
model.train()  # Will force training the model even if a previously trained model exists</code></p>
<p>Class labels can be got for a given (numpy) array of images, <code>img_array</code>, as:
<code>python
model.get_predicted_class_labels(img_array)</code></p>
<h3>Inputs to <code>ConvNet</code></h3>
<ul>
<li><code>training_data_dir</code>: Directory for the training data set. It should be structured as</li>
</ul>
<p>directory/<br/>
...class_a/<br/>
......a_image_1.jpg<br/>
......a_image_2.jpg<br/>
...class_b/<br/>
......b_image_1.jpg<br/>
......b_image_2.jpg<br/>
where <code>class_x</code> contain images with label <code>x</code>.
Supported image formats: <code>jpeg</code>, <code>png</code>, <code>bmp</code>, <code>gif</code>.</p>
<ul>
<li>
<p><code>class_names</code>: List of class names. This list has to match the list that is found
in the training data set.</p>
</li>
<li>
<p><code>num_training_epochs</code>: Number of epochs the model will be trained for.</p>
</li>
<li>
<p><code>batch_size</code>: Number of samples to work through before updating the model parameters.</p>
</li>
<li>
<p><code>img_height</code>, <code>img_width</code>, <code>num_colors</code>: Size of every image in the data set should be the
same and be given by <code>height</code> x <code>width</code> x <code>colors</code>. The values set for these have to be consistent
with the actual image size in the data set.</p>
</li>
</ul>
<p>See <a href="examples/">examples/</a> for example(s) on how to use <code>ConvNet</code>.</p>
<h2>References</h2>
<ul>
<li>https://www.tensorflow.org/tutorials/images/cnn</li>
<li>https://cnvrg.io/cnn-tensorflow/</li>
</ul>
</body>
</html>
